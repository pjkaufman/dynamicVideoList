"use strict";Window.Vinya.functions.fixURLForLanguage=function(n){var i=window.location.href,e=i.substring(i.lastIndexOf("/"));return i=(i=i.substring(0,i.lastIndexOf("/"))).substring(0,i.lastIndexOf("/")),i+="/"+n+e},Window.Vinya.functions.URLContainsParam=function(){for(var n in Window.Vinya.URLParams)if(Window.Vinya.url.searchParams.has(Window.Vinya.URLParams[n]))return!0;return!1},Window.Vinya.functions.updateURLTime=function(){Window.Vinya.player.getCurrentTime().then(function(n){Window.Vinya.functions.updateURL(Window.Vinya.URLParams.time,n)})},Window.Vinya.functions.createVimeoPlayer=function(n){Window.Vinya.videoOptions.id=n,Window.Vinya.player=new Vimeo.Player("videosFrames",Window.Vinya.videoOptions),Window.Vinya.player.on("timeupdate",Window.Vinya.functions.updateURLTime),Window.Vinya.player.on("texttrackchange",function(n){n.language?(Window.Vinya.DOMElements.subtitles.value=n.language,Window.Vinya.functions.updateURL(Window.Vinya.URLParams.sub,n.language)):(Window.Vinya.DOMElements.subtitles.value="off",Window.Vinya.functions.updateURL(Window.Vinya.URLParams.sub,"off"))}),Window.Vinya.player.on("loaded",function(){Window.Vinya.DOMElements.video=document.querySelector("iframe"),Window.Vinya.DOMElements.video.setAttribute("class","resp-iframe"),Window.Vinya.functions.getTextTracks()})},Window.Vinya.functions.getTextTracks=function(){for(var n=document.querySelectorAll(".added"),i=0,e=n.length;i<e;i++)n[i].parentNode.removeChild(n[i]);Window.Vinya.player.getTextTracks().then(function(n){var i,e="",a=!1;if(0!==n.length){for(var t=0,o=n.length;t<o;t++)"subtitles"===n[t].kind&&(e+="<option value="+n[t].language+' class="added">'+n[t].label+"</option>","showing"===n[t].mode&&(i=n[t].language,a=!0));Window.Vinya.DOMElements.subtitles.innerHTML+=e,Window.Vinya.url.searchParams.has(Window.Vinya.URLParams.sub)?Window.Vinya.DOMElements.subtitles.value=Window.Vinya.url.searchParams.get(Window.Vinya.URLParams.sub):a&&(Window.Vinya.DOMElements.subtitles.value=i,Window.Vinya.functions.updateURL(Window.Vinya.URLParams.sub,i))}Window.Vinya.DOMElements.hide("spinner"),Window.Vinya.DOMElements.display("video")})},Window.Vinya.functions.addEventListeners=function(){Window.Vinya.DOMElements.languages.addEventListener("change",function(){Window.Vinya.functions.fixBtnDisplay(Window.Vinya.DOMElements.videoList.value),Window.Vinya.functions.changeVideo(Window.Vinya.DOMElements.videoList.value,!0)}),Window.Vinya.DOMElements.videoList.addEventListener("change",function(){Window.Vinya.functions.displaySelectedVideo()}),Window.Vinya.DOMElements.subtitles.addEventListener("change",function(){"off"==Window.Vinya.DOMElements.subtitles.value?Window.Vinya.player.disableTextTrack():Window.Vinya.player.enableTextTrack(Window.Vinya.DOMElements.subtitles.value)}),Window.Vinya.DOMElements.nextEpisode.addEventListener("click",function(){var n=Window.Vinya.DOMElements.videoList.value,i=parseInt(n.replace(/^\D+/g,"")),e=n.replace(i,""),a=i+1;Window.Vinya.DOMElements.videoList.value=e+a,Window.Vinya.DOMElements.videoTitle.innerText=Window.Vinya.videoList[e+a].title,Window.Vinya.functions.fixBtnDisplay(e+a),Window.Vinya.functions.changeVideo(e+a,!1)}),Window.Vinya.DOMElements.backEpisode.addEventListener("click",function(){var n=Window.Vinya.DOMElements.videoList.value,i=parseInt(n.replace(/^\D+/g,"")),e=n.replace(i,""),a=i-1;Window.Vinya.DOMElements.videoList.value=e+a,Window.Vinya.DOMElements.videoTitle.innerText=Window.Vinya.videoList[e+a].title,Window.Vinya.functions.fixBtnDisplay(e+a),Window.Vinya.functions.changeVideo(e+a,!1)})},Window.Vinya.functions.fixBtnDisplay=function(n){var i=Window.Vinya.DOMElements.languages.value;if(Window.Vinya.videoList[n][i]){Window.Vinya.DOMElements.videoTitle.innerText=Window.Vinya.videoList[n].title;var e=parseInt(n.replace(/^\D+/g,"")),a=n.replace(e,""),t=e+1,o=e-1;null!=Window.Vinya.videoList[a+t]&&null!=Window.Vinya.videoList[a+t][i]?Window.Vinya.DOMElements.display("nextEpisode"):Window.Vinya.DOMElements.hide("nextEpisode"),null!=Window.Vinya.videoList[a+o]&&null!=Window.Vinya.videoList[a+o][i]?Window.Vinya.DOMElements.display("backEpisode"):Window.Vinya.DOMElements.hide("backEpisode")}else Window.Vinya.DOMElements.hide("nextEpisode"),Window.Vinya.DOMElements.hide("backEpisode"),Window.Vinya.DOMElements.videoTitle.innerText=""},Window.Vinya.functions.displaySelectedVideo=function(){var n=Window.Vinya.DOMElements.videoList.value,i=Window.Vinya.DOMElements.languages.value;Window.Vinya.functions.fixBtnDisplay(n),void 0===Window.Vinya.player?Window.Vinya.functions.videoPlayerPreCheck(n)&&(Window.Vinya.functions.createVimeoPlayer(Window.Vinya.videoList[n][i]),Window.Vinya.functions.updateURL(Window.Vinya.URLParams.title,n),Window.Vinya.functions.updateURL(Window.Vinya.URLParams.lang,i)):Window.Vinya.functions.changeVideo(n,!1)},Window.Vinya.functions.changeVideo=function(n,i){Window.Vinya.functions.videoPlayerPreCheck(n)&&(Window.Vinya.DOMElements.videoError.innerText="",Window.Vinya.functions.updateURL(Window.Vinya.URLParams.lang,Window.Vinya.DOMElements.languages.value),Window.Vinya.DOMElements.display("spinner"),Window.Vinya.player.unload().then(function(){Window.Vinya.videoOptions.id=Window.Vinya.videoList[n][Window.Vinya.DOMElements.languages.value],Window.Vinya.player.loadVideo(Window.Vinya.videoOptions).then(function(){Window.Vinya.player.ready().then(function(){i&&Window.Vinya.url.searchParams.has(Window.Vinya.URLParams.time)&&Window.Vinya.player.setCurrentTime(Window.Vinya.url.searchParams.get(Window.Vinya.URLParams.time)),Window.Vinya.DOMElements.hide("spinner"),Window.Vinya.DOMElements.display("video")})})}),i||Window.Vinya.functions.updateURL(Window.Vinya.URLParams.title,n))},Window.Vinya.functions.videoPlayerPreCheck=function(n){return void 0!==Window.Vinya.videoList[n][Window.Vinya.DOMElements.languages.value]||(Window.Vinya.DOMElements.videoError.innerText=Window.Vinya.errorMsg,null!=Window.Vinya.DOMElements.video&&Window.Vinya.DOMElements.hide("video"),Window.Vinya.DOMElements.hide("spinner"),!1)},Window.Vinya.functions.updateURL=function(n,i){n===Window.Vinya.URLParams.title&&Window.Vinya.url.searchParams.delete(Window.Vinya.URLParams.time),Window.Vinya.url.searchParams.has(n)?Window.Vinya.url.searchParams.set(n,i):Window.Vinya.url.searchParams.append(n,i),!Window.Vinya.url.searchParams.has(Window.Vinya.URLParams.sub)||n!==Window.Vinya.URLParams.title&&"off"!=i||Window.Vinya.url.searchParams.delete(Window.Vinya.URLParams.sub),history.pushState&&window.history.pushState({path:Window.Vinya.url.href},"",Window.Vinya.url.href),Window.Vinya.functions.updateStorage()},Window.Vinya.functions.parseURL=function(){var n=Window.Vinya.url.searchParams,i=n.get(Window.Vinya.URLParams.title),e=n.get(Window.Vinya.URLParams.lang),a=n.get(Window.Vinya.URLParams.time),t=n.get(Window.Vinya.URLParams.sub);n.has(Window.Vinya.URLParams.title)&&n.has(Window.Vinya.URLParams.lang)?(Window.Vinya.DOMElements.videoList.value=i,Window.Vinya.DOMElements.languages.value=e):n.has(Window.Vinya.URLParams.title)?(Window.Vinya.DOMElements.videoList.value=i,e=Window.Vinya.DOMElements.languages.value):n.has(Window.Vinya.URLParams.lang)&&(Window.Vinya.DOMElements.languages.value=e,i=Window.Vinya.DOMElements.videoList.value),Window.Vinya.functions.fixBtnDisplay(i),Window.Vinya.functions.videoPlayerPreCheck(i)&&Window.Vinya.functions.createVimeoPlayer(Window.Vinya.videoList[i][e]),n.has(Window.Vinya.URLParams.time)&&Window.Vinya.player.setCurrentTime(a),n.has(Window.Vinya.URLParams.sub)&&Window.Vinya.player.enableTextTrack(t)},Window.Vinya.functions.updateStorage=function(){var n=new URL(Window.Vinya.url.href.substring(0,Window.Vinya.url.href.indexOf("?")));Window.Vinya.url.searchParams.has(Window.Vinya.URLParams.sub)&&n.searchParams.append(Window.Vinya.URLParams.sub,Window.Vinya.url.searchParams.get(Window.Vinya.URLParams.sub)),Window.Vinya.url.searchParams.has(Window.Vinya.URLParams.lang)&&n.searchParams.append(Window.Vinya.URLParams.lang,Window.Vinya.url.searchParams.get(Window.Vinya.URLParams.lang)),Window.Vinya.url.searchParams.has(Window.Vinya.URLParams.title)&&n.searchParams.append(Window.Vinya.URLParams.title,Window.Vinya.url.searchParams.get(Window.Vinya.URLParams.title)),localStorage.setItem(Window.Vinya.localKey,n.search)},document.addEventListener("DOMContentLoaded",function(){Window.Vinya.DOMElements={languages:document.getElementById("languages"),videoList:document.getElementById("videos"),langBtns:document.querySelectorAll("#swapLanguage > p > a"),nextEpisode:document.getElementById("next"),backEpisode:document.getElementById("back"),videoTitle:document.getElementById("title"),videoError:document.getElementById("videoError"),subtitles:document.getElementById("subtitles"),spinner:document.getElementById("loading"),video:void 0,hide:function(n){0===this[n].classList.length.length?this[n].setAttribute("class","hidden"):this[n].classList.add("hidden")},display:function(n){0===this[n].classList.length.length?this[n].setAttribute("class",""):this[n].classList.remove("hidden")}},Window.Vinya.videoOptions={id:void 0,autoplay:!1,title:!1,byline:!1},Window.Vinya.player,Window.Vinya.url=new URL(window.location.href),Window.Vinya.functions.URLContainsParam()?Window.Vinya.functions.parseURL():Window.Vinya.functions.displaySelectedVideo(),Window.Vinya.functions.addEventListeners();for(var n=0,i=Window.Vinya.DOMElements.langBtns.length;n<i;n++)Window.Vinya.DOMElements.langBtns[n].setAttribute("href",Window.Vinya.functions.fixURLForLanguage(Window.Vinya.DOMElements.langBtns[n].id))});